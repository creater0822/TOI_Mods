using System;
using System.Diagnostics;
using System.IO;
using HarmonyLib;
using UnityEngine;
using UnityEngine.UI;

namespace MOD_OBF7hC
{
    [HarmonyPatch(typeof(UILoginBase))]
    [HarmonyPatch("Init")]
    public class Patch_UILoginBase_Init
    {
        public static UIBase prefabUI1;
        public static UIBase prefabUI7;
        public static UIBase YemianKL1UI;
        public static UIBase YemianKL2UI;
        public static UIBase YemianKL3UI;
        public static UIBase YemianKL4UI;
        public static UIBase YemianKL5UI;
        private static GameObject goBoxiang3;

        [HarmonyPostfix]
        public static void PostfixInit()
        {
            prefabUI7 = g.ui.OpenUI(new UIType.UITypeBase("Button1", UILayer.UI));
            if (prefabUI7 != null)
            {
                Transform transform = GameObject.Find("Game/UIRoot/Canvas/Root/UI/Button1/Root/KLimg65").transform;
                int depth = 9999;
                goBoxiang3 = GameEffectTool.CreateGo("Effect/UI/ui_haotianyan_shengji_ztg", transform, depth, 0f);
                goBoxiang3.transform.localScale = new Vector3(1.5f, 1.7f, 1f);
                goBoxiang3.transform.localPosition = new Vector3(179.4552f, 247.6386f, 0f);
            }
            else
            {
                Console.WriteLine("Object named prefabUI7 not found");
            }
            GameObject gameObject = GameObject.Find("Game/UIRoot/Canvas/Root/UI/Button1/Root/KLimg65/KLButton65");
            if (gameObject != null)
            {
                Button component = gameObject.GetComponent<Button>();
                if (component != null)
                {
                    component.onClick.AddListener((Action)OnButtonClicked);
                }
            }
        }

        public static void OnUpdate()
        {
            if (Input.GetMouseButtonDown(1))
            {
                if (YemianKL1UI != null)
                {
                    g.ui.CloseUI(YemianKL1UI);
                    YemianKL1UI = null;
                }
                else if (YemianKL2UI != null)
                {
                    g.ui.CloseUI(YemianKL2UI);
                    YemianKL2UI = null;
                }
                else if (YemianKL3UI != null)
                {
                    g.ui.CloseUI(YemianKL3UI);
                    YemianKL3UI = null;
                }
                else if (YemianKL4UI != null)
                {
                    g.ui.CloseUI(YemianKL4UI);
                    YemianKL4UI = null;
                }
                else if (YemianKL5UI != null)
                {
                    g.ui.CloseUI(YemianKL5UI);
                    YemianKL5UI = null;
                }
                else if (prefabUI1 != null)
                {
                    g.ui.CloseUI(prefabUI1);
                    prefabUI1 = null;
                }
                else if (prefabUI1 == null && YemianKL1UI == null && YemianKL2UI == null && YemianKL3UI == null && YemianKL4UI == null)
                {
                    _ = YemianKL5UI == null;
                }
            }
        }

        private static void OnButtonClicked()
        {
            prefabUI1 = g.ui.OpenUI(new UIType.UITypeBase("Yemian", UILayer.UI));
            if (!(prefabUI1 != null))
            {
                return;
            }
            Transform transform = prefabUI1.transform.Find("KLItme1/KLBtn1");
            Transform transform2 = prefabUI1.transform.Find("KLItme1/KLBtn2");
            Transform transform3 = prefabUI1.transform.Find("KLItme1/KLBtn3");
            Transform transform4 = prefabUI1.transform.Find("KLItme1/KLBtn4");
            Transform transform5 = prefabUI1.transform.Find("KLItme1/KLBtn5");
            Transform transform6 = prefabUI1.transform.Find("KLItme1/KLBtn6");
            if (transform != null)
            {
                Button component = transform.GetComponent<Button>();
                Action action = delegate
                {
                    YemianKL1UI = g.ui.OpenUI(new UIType.UITypeBase("YemianKL1", UILayer.UI));
                    if (YemianKL1UI != null)
                    {
                        Button component22 = YemianKL1UI.transform.Find("Button901").GetComponent<Button>();
                        Action action21 = delegate
                        {
                            g.ui.CloseUI(YemianKL1UI);
                        };
                        component22.onClick.AddListener(action21);
                    }
                };
                component.onClick.AddListener(action);
            }
            if (transform2 != null)
            {
                Button component2 = transform2.GetComponent<Button>();
                Action action2 = delegate
                {
                    YemianKL2UI = g.ui.OpenUI(new UIType.UITypeBase("YemianKL2", UILayer.UI));
                    if (YemianKL2UI != null)
                    {
                        Button component21 = YemianKL2UI.transform.Find("Button108").GetComponent<Button>();
                        Action action20 = delegate
                        {
                            g.ui.CloseUI(YemianKL2UI);
                        };
                        component21.onClick.AddListener(action20);
                    }
                };
                component2.onClick.AddListener(action2);
            }
            if (transform3 != null)
            {
                Button component3 = transform3.GetComponent<Button>();
                Action action3 = delegate
                {
                    YemianKL3UI = g.ui.OpenUI(new UIType.UITypeBase("YemianKL3", UILayer.UI));
                    if (YemianKL3UI != null)
                    {
                        Button component20 = YemianKL3UI.transform.Find("Button107").GetComponent<Button>();
                        Action action19 = delegate
                        {
                            g.ui.CloseUI(YemianKL3UI);
                        };
                        component20.onClick.AddListener(action19);
                    }
                };
                component3.onClick.AddListener(action3);
            }
            if (transform4 != null)
            {
                Button component4 = transform4.GetComponent<Button>();
                Action action4 = delegate
                {
                    YemianKL4UI = g.ui.OpenUI(new UIType.UITypeBase("YemianKL4", UILayer.UI));
                    if (YemianKL4UI != null)
                    {
                        Transform transform10 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu1/KLButton");
                        Transform transform11 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu1/KLButton1");
                        Transform transform12 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu1/KLButton2");
                        Transform transform13 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu2/KLButton");
                        Transform transform14 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu3/KLButton01");
                        Transform transform15 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu3/KLButton02");
                        Transform transform16 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu4/KLButton01");
                        Transform transform17 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu4/KLButton02");
                        Transform transform18 = YemianKL4UI.transform.Find("Root/KLImg/KLimg1/Diyibu4/KLButton03");
                        Transform transform19 = YemianKL4UI.transform.Find("Root/KLImg/ButtonClors");
                        if (transform10 != null)
                        {
                            Button component10 = transform10.GetComponent<Button>();
                            Action action9 = delegate
                            {
                                Application.OpenURL("https://pan.baidu.com/s/1rZjL8S4G7a722RfZqgttxQ?pwd=8888");
                            };
                            component10.onClick.AddListener(action9);
                        }
                        if (transform11 != null)
                        {
                            Button component11 = transform11.GetComponent<Button>();
                            Action action10 = delegate
                            {
                                Application.OpenURL("https://pan.baidu.com/s/1q1YARn_EAWXYztPAWJMKwA?pwd=8888");
                            };
                            component11.onClick.AddListener(action10);
                        }
                        if (transform12 != null)
                        {
                            Button component12 = transform12.GetComponent<Button>();
                            Action action11 = delegate
                            {
                                string dataPath3 = Application.dataPath;
                                string path3 = "ModExportData";
                                string text3 = Path.Combine(Path.GetDirectoryName(dataPath3), path3);
                                if (Directory.Exists(text3))
                                {
                                    Console.WriteLine("Find the ModExportData directory:" + text3);
                                    Process.Start(text3);
                                }
                                else
                                {
                                    Console.WriteLine("ModExportData directory not found!");
                                }
                            };
                            component12.onClick.AddListener(action11);
                        }
                        if (transform13 != null)
                        {
                            Button component13 = transform13.GetComponent<Button>();
                            Action action12 = delegate
                            {
                                string dataPath2 = Application.dataPath;
                                string path2 = "ModExportData/Mod_OBF7hC";
                                string text2 = Path.Combine(Path.GetDirectoryName(dataPath2), path2);
                                if (Directory.Exists(text2))
                                {
                                    Console.WriteLine("Find the ModExportData/Mod_OBF7hC directory：" + text2);
                                    Process.Start(text2);
                                }
                                else
                                {
                                    Console.WriteLine("ModExportData/Mod_OBF7hC directory not found!");
                                }
                            };
                            component13.onClick.AddListener(action12);
                        }
                        if (transform14 != null)
                        {
                            Button component14 = transform14.GetComponent<Button>();
                            Action action13 = delegate
                            {
                                Application.OpenURL("https://www.paddi.vip/guigu/kl");
                            };
                            component14.onClick.AddListener(action13);
                        }
                        if (transform15 != null)
                        {
                            Button component15 = transform15.GetComponent<Button>();
                            Action action14 = delegate
                            {
                                string dataPath = Application.dataPath;
                                string path = "ModExportData/Mod_OBF7hC/ModAssets";
                                string text = Path.Combine(Path.GetDirectoryName(dataPath), path);
                                if (Directory.Exists(text))
                                {
                                    Console.WriteLine("The Koala secret key is stored in the ModExportData/Mod_OBF7hC/ModAssets directory：" + text);
                                    Process.Start(text);
                                }
                                else
                                {
                                    Console.WriteLine("The Koala key storage ModExportData/Mod_OBF7hC/ModAssets directory was not found!");
                                }
                            };
                            component15.onClick.AddListener(action14);
                        }
                        if (transform16 != null)
                        {
                            Button component16 = transform16.GetComponent<Button>();
                            Action action15 = delegate
                            {
                                Application.OpenURL("https://qm.qq.com/q/tfM5BwpRkY");
                            };
                            component16.onClick.AddListener(action15);
                        }
                        if (transform17 != null)
                        {
                            Button component17 = transform17.GetComponent<Button>();
                            Action action16 = delegate
                            {
                                Application.OpenURL("https://qm.qq.com/q/xzGjcGTxT4");
                            };
                            component17.onClick.AddListener(action16);
                        }
                        if (transform18 != null)
                        {
                            Button component18 = transform18.GetComponent<Button>();
                            Action action17 = delegate
                            {
                                Application.OpenURL("https://qm.qq.com/q/9ThuUzb1mM");
                            };
                            component18.onClick.AddListener(action17);
                        }
                        if (transform19 != null)
                        {
                            Button component19 = transform19.GetComponent<Button>();
                            Action action18 = delegate
                            {
                                g.ui.CloseUI(YemianKL4UI);
                            };
                            component19.onClick.AddListener(action18);
                        }
                    }
                };
                component4.onClick.AddListener(action4);
            }
            if (transform5 != null)
            {
                Button component5 = transform5.GetComponent<Button>();
                Action action5 = delegate
                {
                    YemianKL5UI = g.ui.OpenUI(new UIType.UITypeBase("YemianKL5", UILayer.UI));
                    if (YemianKL5UI != null)
                    {
                        Transform transform7 = YemianKL5UI.transform.Find("KLButton109");
                        Transform transform8 = YemianKL5UI.transform.Find("Root/KLImage/KLButton402");
                        Button component7 = transform7.GetComponent<Button>();
                        Button component8 = transform8.GetComponent<Button>();
                        Action action7 = delegate
                        {
                            g.ui.CloseUI(YemianKL5UI);
                        };
                        component7.onClick.AddListener(action7);
                        Transform transform9 = GameObject.Find("Game/UIRoot/Canvas/Root/UI/YemianKL5/Root/KLImage").transform;
                        int depth = 9999;
                        goBoxiang3 = GameEffectTool.CreateGo("Effect/UI/genpilong_huaxing_nv", transform9, depth, 0f);
                        goBoxiang3.transform.localScale = new Vector3(1.5f, 1.5f, 1f);
                        goBoxiang3.transform.localPosition = new Vector3(355.8183f, 177.4568f, 0f);
                        if (component8 != null)
                        {
                            Button component9 = component8.GetComponent<Button>();
                            Action action8 = delegate
                            {
                                Application.OpenURL("https://afdian.net/a/kaolas");
                            };
                            component9.onClick.AddListener(action8);
                        }
                    }
                };
                component5.onClick.AddListener(action5);
            }
            if (transform6 != null)
            {
                Button component6 = transform6.GetComponent<Button>();
                Action action6 = delegate
                {
                    Console.WriteLine("Clicked on option 6");
                };
                component6.onClick.AddListener(action6);
            }
        }
    }
}
